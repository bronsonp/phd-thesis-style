%%
%% This is file `phdthesis.sty`,
%%
%% This style file changes the appearance of the pages to improve
%% the aesthetics of PhD theses (in my opinion =)
%%
%% Copyright (C) 2007  Jamie Stevens
%% Modified for JCU by Bronson Philippa and Chris Jordan
%%
%%
%%  This program is free software: you can redistribute it and/or modify
%%  it under the terms of the GNU General Public License as published by
%%  the Free Software Foundation, either version 3 of the License, or
%%  (at your option) any later version.
%%
%%  This program is distributed in the hope that it will be useful,
%%  but WITHOUT ANY WARRANTY; without even the implied warranty of
%%  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%%  GNU General Public License for more details.
%%
%%  You should have received a copy of the GNU General Public License
%%  along with this program.  If not, see <http://www.gnu.org/licenses/>.
%%
\NeedsTeXFormat{LaTeX2e}[1994/06/01]
\ProvidesPackage{phdthesis}[2007/09/11 v1.0 PhD Thesis Style]

%% hyperlink DOIs
\RequirePackage{doi}

%% merge citation numbers
\RequirePackage{cite}

%% change the equation number appearance
%% load up the AMS math package
\RequirePackage{amsmath}

%% load up the fancy box making package
\RequirePackage{fancybox}

%% make the equation numbers have little ovals around them
%\def\tagform@#1{\maketag@@@{\cornersize{0.8}\ovalbox{\ignorespaces\sffamily{#1}\unskip\@@italiccorr}}}

%% Load up PS insertion package
\RequirePackage{psboxit}
\PScommands

% We need colour support
\RequirePackage{color}

%% Load up fancy headers and footers package
\RequirePackage{fancyhdr}

%% now reset the headers and footers
\fancyhead{}
\fancyfoot{}
%% Set the headers and footers as per JCU's requirements
\fancyhead[RE,RO]{\slshape \@shorttitle}
\fancyhead[LE,LO]{\slshape \@abbrev}
%\fancyfoot[RE,RO]{\slshape \thepage}
\fancyfoot[LE,LO]{\slshape\nouppercase \leftmark}
\fancyfoot[C]{}

%% put the page numbers on the bottom in a nice box
%\definecolor{pagenogrey}{rgb}{0.8,0.8,0.8}
%\fancyfoot[RE,RO]{\fcolorbox{black}{pagenogrey}{\makebox[8mm][c]{\bfseries \thepage}}}
\fancyfoot[RE,RO]{\bfseries \thepage}

%% make the bottom line above the page number box
\renewcommand{\footrulewidth}{0.4pt}
\renewcommand{\footruleskip}{0mm}

%% bring the style into effect
\pagestyle{fancy}

%% now redefine the plain style pages (chapter pages, contents pages)
%% to have the same page number stuff on the bottom
\fancypagestyle{plain}{
\fancyhf{}
%\fancyfoot[RE,RO]{\fcolorbox{black}{pagenogrey}{\makebox[8mm][c]{\bfseries \thepage}}}
\fancyfoot[RE,RO]{\bfseries \thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.5pt}
}

%% this next section (till \makeatother) makes sure that blank pages
%% are actually completely blank, cause they're not usually
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
	\hbox{}
	\vspace*{\fill}
	\thispagestyle{empty}
	\newpage
	\if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother


%% now change the chapter style
%% load up the quotchap package
\RequirePackage[avantgarde]{quotchap}

%% make the quotation appear next to the chapter number
%\renewcommand\chapterheadstartvskip{\vspace*{-5\baselineskip}}

%% load up the fancy title-style package
\RequirePackage[calcwidth]{titlesec}
%% change the chapter font
\usepackage{fontspec}
\setsansfont[Mapping=tex-text]{Open Sans}
\newfontfamily{\os}{Open Sans}
\newfontfamily{\osl}[UprightFont={* Light}]{Open Sans}
%\usepackage[defaultsans]{opensans}
\renewcommand*{\sectfont}{\osl\fontseries{l}\Huge\selectfont}

%% now change the section heading to have a line beneath it
\titleformat{\section}[hang]{\osl\fontseries{l}\selectfont}
{\LARGE\thesection}{12pt}{\LARGE}[{\titlerule[0.5pt]}]

\titleformat{\subsection}[hang]{\osl\fontseries{m}\selectfont}
{\large\thesubsection}{12pt}{\large}


%% Define a macro for special handling when compiling chapter documents separately
\newif\ifChapterOnly
\ChapterOnlytrue

%% Allow the use of \bibentry to produce a formatted citation for the
%% List of Publications page
\usepackage{bibentry}
\nobibliography*


%%
%% End of file `phdthesis.sty`
